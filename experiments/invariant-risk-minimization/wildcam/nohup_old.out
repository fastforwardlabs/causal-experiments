

====================IRM====================
{'n_restarts': 1, 'steps': 51, 'n_classes': 2, 'fc_only': True, 'model_path': './', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 10, 'penalty_weight': 3.0}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
feature extraction
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	0.7344		0.7301		0.004		0.463		0.6503		0.6133
10	0.1811		0.5068		0.0121		0.771		0.5837		0.6767
20	0.1716		0.4815		0.011		0.7665		0.5839		0.6782
30	0.1628		0.4601		0.0093		0.7655		0.5978		0.6796
40	0.1565		0.4446		0.0082		0.768		0.6022		0.6751
50	0.1512		0.433		0.0067		0.7725		0.5984		0.667
Final train acc (mean/std across restarts so far):
0.7725 0.0
Final test acc (mean/std across restarts so far):
0.667 0.0


====================IRM====================
{'n_restarts': 1, 'steps': 501, 'n_classes': 2, 'fc_only': True, 'model_path': './', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 100, 'penalty_weight': 3.0}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
feature extraction
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	0.7344		0.7301		0.004		0.463		0.6503		0.6133
10	0.5164		0.5039		0.0121		0.7715		0.5836		0.6767
20	0.4523		0.4409		0.011		0.794		0.579		0.6869
30	0.4175		0.4086		0.0085		0.8105		0.5976		0.6808
40	0.3955		0.3871		0.0079		0.8125		0.5982		0.6832
50	0.382		0.3751		0.0064		0.827		0.5991		0.6644
60	0.3743		0.368		0.0057		0.8265		0.6146		0.6773
70	0.363		0.3564		0.0059		0.831		0.6134		0.6864
80	0.355		0.3493		0.0052		0.8325		0.6196		0.6848
90	0.3477		0.342		0.005		0.8455		0.6143		0.6749
100	0.1167		0.3344		0.005		0.8445		0.6293		0.6862
110	0.1162		0.3341		0.0046		0.847		0.6379		0.6855
120	0.117		0.3387		0.0039		0.8425		0.644		0.6733
130	0.1171		0.3345		0.0053		0.8475		0.6255		0.6747
140	0.1139		0.3303		0.0036		0.8445		0.6461		0.6778
150	0.1138		0.3295		0.0037		0.849		0.6411		0.6848
160	0.1139		0.3314		0.0032		0.837		0.6353		0.6824
170	0.1118		0.3252		0.0031		0.848		0.6563		0.6885
180	0.1117		0.324		0.0035		0.8515		0.6385		0.6862
190	0.1109		0.321		0.0036		0.8475		0.6458		0.6717
200	0.1117		0.3235		0.0036		0.848		0.6382		0.69
210	0.1125		0.3262		0.0034		0.8485		0.6572		0.6769
220	0.1094		0.3171		0.0035		0.8505		0.6509		0.6952
230	0.1094		0.317		0.0034		0.853		0.6159		0.6883
240	0.1089		0.3158		0.0033		0.854		0.6595		0.6815
250	0.1096		0.3162		0.0039		0.853		0.6426		0.6799
260	0.1089		0.316		0.0033		0.8495		0.6373		0.6905
270	0.1091		0.3154		0.0036		0.8555		0.6418		0.6885
280	0.1086		0.3124		0.0041		0.853		0.6364		0.693
290	0.1089		0.3125		0.0044		0.855		0.6533		0.6823
300	0.108		0.3122		0.0036		0.86		0.6334		0.6679


====================IRM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': True, 'model_path': './models', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 100, 'penalty_weight': 3.0}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
feature extraction
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	0.7344		0.7301		0.004		0.463		0.6503		0.6133
10	0.5164		0.5039		0.0121		0.7715		0.5836		0.6767
20	0.4523		0.4409		0.011		0.794		0.579		0.6869
30	0.4175		0.4086		0.0085		0.8105		0.5976		0.6808
40	0.3955		0.3871		0.0079		0.8125		0.5982		0.6832
Final train acc (mean/std across restarts so far):
0.8215 0.0
Final test acc (mean/std across restarts so far):
0.6824 0.0
Traceback (most recent call last):
  File "main.py", line 94, in <module>
    torch.save(train_process.clf.state_dict(), args['model_path'])
  File "/home/nisha/anaconda3/envs/irm/lib/python3.7/site-packages/torch/serialization.py", line 327, in save
    with _open_file_like(f, 'wb') as opened_file:
  File "/home/nisha/anaconda3/envs/irm/lib/python3.7/site-packages/torch/serialization.py", line 212, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/nisha/anaconda3/envs/irm/lib/python3.7/site-packages/torch/serialization.py", line 193, in __init__
    super(_open_file, self).__init__(open(name, mode))
IsADirectoryError: [Errno 21] Is a directory: './models'


====================IRM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': True, 'model_path': './models/wildcam_IRM.pth', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 100, 'penalty_weight': 3.0}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
feature extraction
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	0.7344		0.7301		0.004		0.463		0.6503		0.6133
10	0.5164		0.5039		0.0121		0.7715		0.5836		0.6767
20	0.4523		0.4409		0.011		0.794		0.579		0.6869
30	0.4175		0.4086		0.0085		0.8105		0.5976		0.6808
40	0.3955		0.3871		0.0079		0.8125		0.5982		0.6832
Final train acc (mean/std across restarts so far):
0.8215 0.0
Final test acc (mean/std across restarts so far):
0.6824 0.0


====================ERM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': True, 'model_path': './models/wildcam_ERM.pth', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 0, 'penalty_weight': 0.0}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
feature extraction
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	0.7344		0.734		0.0045		0.46		0.6528		0.6098
10	0.4988		0.4985		0.0127		0.777		0.5836		0.6767
20	0.4371		0.4367		0.0122		0.802		0.5756		0.6855
30	0.4055		0.4051		0.0105		0.822		0.5918		0.6801
40	0.3836		0.3832		0.0105		0.825		0.5883		0.6796
Final train acc (mean/std across restarts so far):
0.8315 0.0
Final test acc (mean/std across restarts so far):
0.681 0.0




====================IRM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': True, 'model_path': './models/wildcam_IRM.pth', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 10, 'penalty_weight': 3.0}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
feature extraction
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	0.7555		0.749		0.0062		0.4165		0.6722		0.5492
10	0.1816		0.5129		0.0105		0.7585		0.5722		0.7139
20	0.1728		0.489		0.0096		0.761		0.5706		0.6847
30	0.1646		0.4687		0.0082		0.7655		0.5605		0.7078
40	0.1575		0.4499		0.0074		0.777		0.5577		0.7001
Final train acc (mean/std across restarts so far):
0.7775 0.0
Final test acc (mean/std across restarts so far):
0.7049 0.0


====================ERM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': True, 'model_path': './models/wildcam_ERM.pth', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 0, 'penalty_weight': 0.0}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
feature extraction
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	0.7543		0.754		0.007		0.4095		0.6767		0.542
10	0.5054		0.5051		0.0113		0.764		0.5671		0.7153
20	0.4377		0.4373		0.0131		0.805		0.5373		0.7258
30	0.4044		0.4039		0.0117		0.8225		0.526		0.7392
40	0.3752		0.3747		0.0127		0.836		0.5172		0.7419
Final train acc (mean/std across restarts so far):
0.8435 0.0
Final test acc (mean/std across restarts so far):
0.7403 0.0


====================IRM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': True, 'model_path': './models/wildcam_IRM.pth', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 10, 'penalty_weight': 5.0}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
feature extraction
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	0.7555		0.749		0.0062		0.4165		0.6722		0.5492
10	0.1133		0.5136		0.0105		0.7585		0.5731		0.7139
20	0.1092		0.5119		0.0067		0.744		0.5986		0.6633
30	0.1056		0.498		0.0059		0.749		0.5914		0.6791
40	0.1018		0.484		0.0049		0.7505		0.5906		0.6765
Final train acc (mean/std across restarts so far):
0.754 0.0
Final test acc (mean/std across restarts so far):
0.6764 0.0


====================IRM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': True, 'model_path': './models/wildcam_IRM.pth', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 10, 'penalty_weight': 1.5}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
feature extraction
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	0.7555		0.749		0.0062		0.4165		0.6722		0.5492
10	0.3518		0.5113		0.0106		0.7595		0.5704		0.7153
20	0.3191		0.4618		0.011		0.786		0.5502		0.7151
30	0.2978		0.4328		0.009		0.7975		0.5381		0.73
40	0.2808		0.4079		0.0086		0.8125		0.5335		0.7246
Final train acc (mean/std across restarts so far):
0.8105 0.0
Final test acc (mean/std across restarts so far):
0.723 0.0


====================IRM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': False, 'model_path': './models/wildcam_IRM_finetune.pth', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 10, 'penalty_weight': 1.5}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
Traceback (most recent call last):
  File "main.py", line 91, in <module>
    train_acc, test_acc = train_process.train()
  File "/home/nisha/causal-experiments/experiments/invariant-risk-minimization/wildcam/train.py", line 144, in train
    optimizer = optim.SGD(self.clf.parameters(), **self.args['optimizer_args']['lr'])
TypeError: type object argument after ** must be a mapping, not float


====================IRM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': False, 'model_path': './models/wildcam_IRM_finetune.pth', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 10, 'penalty_weight': 1.5}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	7.958		0.7074		0.0029		0.494		0.6433		0.6437
10	5.0818		0.3579		0.0151		0.8485		0.5383		0.716
20	5.0339		0.296		0.0111		0.875		0.5191		0.7282
30	5.0004		0.2544		0.0078		0.897		0.5017		0.7435
40	4.9705		0.2126		0.0083		0.924		0.4851		0.7585
Final train acc (mean/std across restarts so far):
0.9325 0.0
Final test acc (mean/std across restarts so far):
0.768 0.0


====================ERM====================
{'n_restarts': 1, 'steps': 50, 'n_classes': 2, 'fc_only': False, 'model_path': './models/wildcam_ERM_finetune.pth', 'transform': {'train': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
), 'test': Compose(
    CenterCrop(size=(224, 224))
    ToTensor()
    Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])
)}, 'loader_tr_args': {'batch_size': 100, 'num_workers': 1}, 'loader_te_args': {'batch_size': 100, 'num_workers': 1}, 'loader_sample_args': {'batch_size': 100, 'num_workers': 1}, 'optimizer_args': {'lr': 0.001, 'l2_regularizer_weight': 0.001, 'penalty_anneal_iters': 0, 'penalty_weight': 0.0}}
../../../data/wildcam_subset_sample/train
== Found 2000 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/train/coyote/585c03da-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585dabb3-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4c7d-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/train/coyote/585f4cda-23d2-11e8-a6a3-ec086b02610b.jpg']
../../../data/wildcam_subset_sample/valid
== Found 1319 items 
== Found 2 classes
['/coyote', '/raccoon']
['../../../data/wildcam_subset_sample/valid/raccoon/5858bffe-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c09a-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c0ac-23d2-11e8-a6a3-ec086b02610b.jpg'
 '../../../data/wildcam_subset_sample/valid/raccoon/5858c226-23d2-11e8-a6a3-ec086b02610b.jpg']
class_indices:  [(0, '/coyote'), (1, '/raccoon')]
x_train:  2000
y_train:  torch.Size([2000])
x_test:  1319
y_test:  torch.Size([1319])
Using GPU - True
step	train loss	train nll	train penalty	train acc	test loss	test acc
0	7.9624		0.7147		0.0034		0.484		0.6469		0.638
10	7.5877		0.3457		0.0199		0.862		0.5307		0.7223
20	7.4915		0.2552		0.0176		0.9185		0.5033		0.7483
30	7.436		0.2054		0.0135		0.933		0.4897		0.7541
40	7.386		0.1612		0.0127		0.951		0.4719		0.7607
Final train acc (mean/std across restarts so far):
0.9595 0.0
Final test acc (mean/std across restarts so far):
0.7618 0.0
